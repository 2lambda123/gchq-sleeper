<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright 2022-2023 Crown Copyright
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<suppressions xmlns="https://jeremylong.github.io/DependencyCheck/dependency-suppression.1.3.xsd">
    <suppress>
        <notes><![CDATA[
        Spark is suppressed as the version we are able to use is restricted by support in AWS EMR:
        https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-release-components.html
        ]]></notes>
        <packageUrl regex="true">^pkg:maven/org\.apache\.spark/.*$</packageUrl>
        <cpe>cpe:/a:apache:spark:3.3.1</cpe>
    </suppress>
    <suppress>
        <notes><![CDATA[
        Spark is suppressed as the version we are able to use is restricted by support in AWS EMR:
        https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-release-components.html

        Some of the Spark dependencies were not identified by the Spark CPE, so we've added this to catch
        several shaded dependencies.
        ]]></notes>
        <filePath regex="true">^.*/spark-[^/]+-3\.3\.1\.jar/.*$</filePath>
        <vulnerabilityName regex="true">.*</vulnerabilityName>
    </suppress>
    <suppress>
        <notes><![CDATA[
        Hadoop is suppressed as the version we are able to use is restricted by support in AWS EMR:
        https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-release-components.html
        ]]></notes>
        <packageUrl regex="true">^pkg:maven/org\.apache\.hadoop/.*$</packageUrl>
        <cpe>cpe:/a:apache:hadoop:3.3.3</cpe>
    </suppress>
    <suppress>
        <notes><![CDATA[
        Hadoop is suppressed as the version we are able to use is restricted by support in AWS EMR:
        https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-release-components.html

        Some of the Hadoop dependencies were not identified by the Hadoop CPE, so we've added this to catch
        several shaded dependencies.
        ]]></notes>
        <filePath regex="true">^.*/hadoop-client-[^/]+-3\.3\.3\.jar/.*$</filePath>
        <vulnerabilityName regex="true">.*</vulnerabilityName>
    </suppress>
    <suppress>
        <notes><![CDATA[
        The version of Hadoop we're using uses an old version of Jackson, with old Maven artifacts that don't have a
        fixed version.
        ]]></notes>
        <packageUrl regex="true">^pkg:maven/org\.codehaus\.jackson/jackson\-mapper\-asl@.*$</packageUrl>
        <vulnerabilityName>CVE-2017-7525</vulnerabilityName>
    </suppress>
    <suppress>
        <notes><![CDATA[
        The version of Hadoop we're using uses an old version of Jackson, with old Maven artifacts that don't have a
        fixed version.
        ]]></notes>
        <packageUrl regex="true">^pkg:maven/org\.codehaus\.jackson/jackson\-mapper\-asl@.*$</packageUrl>
        <vulnerabilityName>CVE-2019-10172</vulnerabilityName>
    </suppress>
    <suppress>
        <notes><![CDATA[
        The version of Hadoop we're using uses an old version of OkHttp, with old Maven artifacts that don't have a
        fixed version.
        ]]></notes>
        <packageUrl regex="true">^pkg:maven/com\.squareup\.okhttp/okhttp@.*$</packageUrl>
        <vulnerabilityName>CVE-2021-0341</vulnerabilityName>
    </suppress>
    <suppress>
        <notes><![CDATA[
        The AWS CDK uses Javascript code with a vulnerable NPM package. Once there's a version of the CDK that doesn't,
        we can use that instead.
        file name: cdk-asset-awscli-v1-2.2.199.jar: asset-awscli-v1@2.2.199.jsii.tgz: asset-awscli-v1@2.2.199.jsii.tar: layer.zip: endpoint-rule-set-1.json.gz
        ]]></notes>
        <filePath regex="true">^.*/cdk-asset-awscli-v1-2\.2\.199\.jar/.*$</filePath>
        <cve>CVE-2021-23497</cve>
    </suppress>
    <suppress>
        <notes><![CDATA[
        The AWS CDK uses a vulnerable Ruby gem. Once there's a version of the CDK that doesn't, we can use that instead.
        file name: cdk-asset-awscli-v1-2.2.199.jar: asset-awscli-v1@2.2.199.jsii.tgz: asset-awscli-v1@2.2.199.jsii.tar: layer.zip: endpoint-rule-set-1.json.gz
        ]]></notes>
        <filePath regex="true">^.*/cdk-asset-awscli-v1-2\.2\.199\.jar/.*$</filePath>
        <cve>CVE-2020-10663</cve>
    </suppress>
</suppressions>